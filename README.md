# How Do We Fight Against Evolving Go Language Malware? : Practical Techniques to Improve Analytical Skills (進化するGo言語製マルウェアとどう戦うか？: 解析能力向上に向けての実践的テクニック)
I gave a presentation at JSAC on the analysis of Go malware.
Here is the script we presented at that time.

## Content
### Ghidra script to deobfuscate strings of Go malware with gobfuscate
[degobfuscate.py](https://github.com/mooncat-greenpy/Ghidra_GolangAnalyzerExtension/blob/1584493a62db06348421c3455a4457ca68fd7013/ghidra_scripts/degobfuscate.py)

This Ghidra script deobfuscates strings of Go malware with [gobfuscate](https://github.com/unixpickle/gobfuscate) like ChaChi and Blackrota.
The script is provided as a part of [GolangAnalyzerExtension](https://github.com/mooncat-greenpy/Ghidra_GolangAnalyzerExtension) plugin, so it can be run from Ghidra's Script Manager once this plugin is installed.
Please note that it will not work without this plugin.

Below is a the result of deobfuscating malware ChaChi with degobfuscate.py.  
SHA256: `8a9205709c6a1e5923c66b63addc1f833461df2c7e26d9176993f14de2a39d5b`

<img src="img/chachi_8a920570_main_init_gobfus.png" width="1000" alt="main.init function">

### Radare2 script to resolve function names in Go binary supporting Go 1.18
[gohelper_go118.py](r2-go-helpers/gohelper_go118.py)

gohelper_go118.py is a script that makes [gohelper.py](https://github.com/f0rki/r2-go-helpers), which does not support Go 1.16 or later, compatible with Go 1.18.
However, this script does not support versions prior to Go 1.18.
The commit is [here](https://github.com/FFRI/JSAC2023-GolangMalwareAnalysis/compare/9626de3440bc0d5181ae89a28cf86349821361f6...7d1aaa8c32a8f94a1c446689466e440569d94508).


Below are the results of resolving function names of malware Chaos with gohelper_go118.py using afl and pdf commands.  
SHA256: `ebe0f9855eb8f6bd980ed60c26e3a877dc1ace5d664e248bb0558996fe0bd06f`

<img src="img/chaos_ebe0f9855_radare2_afl.png" width="542" alt="afl command">  
<img src="img/chaos_ebe0f9855_radare2_pdf_main_main.png" width="645" alt="pdf command">  
